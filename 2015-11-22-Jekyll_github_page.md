---
title: "Jekyll的本地环境搭建及编译"
date: 2015-11-22 00:00:00
category: 笔记
tags: [github,Jekyll]
---
## 注意点
1. 关于源的问题
	1.1 有些时候外网不是很好访问，这个时候就需要访问一些镜像网站了，如在下载某些插件或更新Ruby的时候可以将源指向https://ruby.taobao.org/
	1.2 还有就是自己花钱买专用网络通道了
2. 关于Ruby的版本
	最好下载的时候将Ruby和RubyDevKit的版本下载一个版本的
3. 关于gem的介绍
	网上有些教程还说要下载什么gem系统，其实现在已经不用了，因为ruby已经集成了


## 本地环境的搭建
### 第一步：Ruby的安装
jekyll本身基于Ruby开发，因此，想要在本地构建一个测试环境需要具有Ruby的开发和运行环境。在windows下，可以使用Rubyinstaller安装。
## 第二步：RubyDevKit安装
从这里[下载DevKit](http://rubyinstaller.org/downloads/)，**注意版本要与Ruby版本一致**

下载下来的是一个压缩文件，如果你安装有7-zip，可以直接双击，它会自解压到你所选择的目录。建议安装在和Ruby的同级目录下，例如：两者同时安装在D盘根目录下。

解压完成之后，用cmd进入到刚才解压的目录下，运行下面命令，该命令会生成config.yml。

```ruby
ruby dk.rb init
```
<font color = "red">config.yml</font>文件实际上是检测系统安装的ruby的位置并记录在这个文件中，以便稍后使用。但上面的命令只针对使用rubyinstall安装的ruby有效，如果是其他方式安装的话，需要手动修改config.yml。我生成的config.yml文件内容如下：（注意路径用的是linux的斜杠方向）

```
# This configuration file contains the absolute path locations of all
# installed Rubies to be enhanced to work with the DevKit. This config
# file is generated by the 'ruby dk.rb init' step and may be modified
# before running the 'ruby dk.rb install' step. To include any installed
# Rubies that were not automagically discovered, simply add a line below
# the triple hyphens with the absolute path to the Ruby root directory.
#
# Example:
#
# ---
# - C:/ruby19trunk
# - C:/ruby192dev
#
---
- E:/Dev/Ruby22-x64
```

最后，执行如下命令，执行安装：

```ruby
ruby setup.rb
```

如果没有setup.rb的话，执行：

```ruby
ruby dk.rb install
```
## 第三步：Ruby gems的安装(可免，Ruby已经集成)
Rubygems是类似Radhat的RPM、centOS的Yum、Ubuntu的apt-get的应用程序打包部署解决方案。Rubygems本身基于Ruby开发，在Ruby命令行中执行。我们需要它主要是因为jekyll的执行需要依赖很多Ruby应用程序，如果一个个手动安装比较繁琐。jekyll作为一个Ruby的应用，也实现了Rubygems打包标准。只要通过简单的命令就可以自动下载其依赖。

**更新ruby和gems系统时**

```ruby
gem update --system
```
> 现在的Ruby版本都已经默认安装了gem，所有就没有大费周折的去绕过天朝的墙了，不过由于源问题，还是留一手比较好

```ruby
$ gem sources --remove http://rubygems.org/
$ gem sources -a http://ruby.taobao.org/
$ gem sources -l
```
## 第四步：安装jekyll(可免,见第6步)
有了上面的基础，安装jekyll就十分轻松了，执行下面gem命令即可全自动搞定：

```ruby
$ gem install jekyll
```

## 第五步：安装Bundle
> 以前搭建Jekyll本地环境的时候步骤非常复杂，不过现在情况变的更简单了，github有一个对应的gem，可以”一键”配置环境，具体可以参考[Using Jekyll with Pages](https://help.github.com/articles/using-jekyll-with-pages)。

直接使用下面命令即可：

```ruby
$ gem install bundle
```


## 第六步：Gemfile和Bundle安装
在你blog项目的根目录下创建一个叫Gemfile的文件，注意没有后缀，输入下面内容

```ruby
source 'https://ruby.taobao.org/'

gem 'jekyll'
gem 'jekyll-paginate'
gem 'redcarpet', '~> 3.2.3'
gem 'jekyll-watch', '~> 1.2.1'
gem 'pygments.rb'
gem 'kramdown'
gem 'wdm', '>= 0.1.0' if Gem.win_platform?
```

保存后，在命令行中执行

```bash
$ bundle install
```

命令会根据当前目录下的Gemfile，安装所需要的所有软件。这一步所安装的东西，可以说跟github本身的环境是完全一致的，所以可以确保本地如果没有错误，上传后也不会有错误。而且可以在将来使用下面命令，随时更新环境，十分方便

```bash
$ bundle update
```
## 第七步：启动转化和本地服务

```bash
$ bundle exec jekyll serve
```